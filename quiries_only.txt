CREATE TABLE IF NOT EXISTS enquiry (id int, name string, email string, mobile string, course string, price int, demo_days int, date string, status string, activity string) COMMENT 'Enquiry Details' ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' STORED AS TEXTFILE;
LOAD DATA LOCAL INPATH '/home/cloudera/Files/Project/Hive-Project/Dataset/enquiry.csv' OVERWRITE INTO TABLE enquiry; 
SELECT * FROM enquiry LIMIT 5;
CREATE TABLE IF NOT EXISTS enroll (id int, name string, email string, mobile string, course string, status string, payment_mode string, total_installment int, installment_paid int, next_installment_date string, payment_status string, installment_left int, final_amount int) COMMENT 'Enrollment Details' ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' STORED AS TEXTFILE;
LOAD DATA LOCAL INPATH '/home/cloudera/Files/Project/Hive-Project/Dataset/enroll.csv' OVERWRITE INTO TABLE enroll; 
SELECT * FROM enroll LIMIT 5;
CREATE TABLE IF NOT EXISTS batch (id int, name string, email string, mobile string, course string, joining_date string, week_day string, day string, time string, mode string) COMMENT 'Batchwise Distribution Details' ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' STORED AS TEXTFILE;
LOAD DATA LOCAL INPATH '/home/cloudera/Files/Project/Hive-Project/Dataset/batch_distribution.csv' OVERWRITE INTO TABLE batch; 
SELECT * FROM batch LIMIT 5;
CREATE TABLE IF NOT EXISTS demo_schedule (id int, name string, email string, mobile string, course string, weekday string, demo_day string, demo_date string, time string) COMMENT 'Demo Schedule Details' ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' STORED AS TEXTFILE;
LOAD DATA LOCAL INPATH '/home/cloudera/Files/Project/Hive-Project/Dataset/demo_schedule.csv' OVERWRITE INTO TABLE demo_schedule; 
SELECT * FROM demo_schedule LIMIT 5;
CREATE TABLE IF NOT EXISTS demo_missed (id int, name string, email string, mobile string, course string, reschedule_date string, reschedule_time string) COMMENT 'Demo Missed Details' ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' STORED AS TEXTFILE;
LOAD DATA LOCAL INPATH '/home/cloudera/Files/Project/Hive-Project/Dataset/demo_missed.csv' OVERWRITE INTO TABLE demo_missed; 
SELECT * FROM demo_missed LIMIT 5;
SELECT c.id,c.name,c.email,c.mobile,c.course,c.status,o.demo_day,o.demo_date,o.time FROM enquiry c JOIN demo_schedule o ON (c.id= o.id);
SELECT c.id,c.name,c.email,c.mobile,c.course,c.status,o.reschedule_date,o.reschedule_time FROM enquiry c JOIN demo_missed o ON (c.id = o.id);
SELECT e.id,e.name,e.email,e.mobile,e.course,b.joining_date,b.week_day,b.day,b.time FROM enroll e JOIN batch b ON(e.id=b.id);
SELECT e.id,e.name,e.email,e.mobile,e.course,b.joining_date,b.week_day,b.day,b.time FROM enroll e JOIN batch b ON(e.id=b.id) where b.day='Saturday';
SELECT e.id,e.name,e.email,e.mobile,e.course,b.joining_date,b.week_day,b.day,b.time FROM enroll e JOIN batch b ON(e.id=b.id) where b.day='Wednesday';
SELECT e.id,e.name,e.email,e.mobile,e.course,b.joining_date,b.week_day,b.day,b.time FROM enroll e JOIN batch b ON(e.id=b.id) where week_day='WD';
SELECT id,name,email,mobile,course,payment_mode FROM enroll where payment_mode='Phonepe';
SELECT id,name,email,mobile,course,payment_mode FROM enroll where payment_mode='Googlepay';
SELECT id,name,email,mobile,course,payment_mode FROM enroll where payment_mode='Card';
SELECT id,name,email,mobile,course,payment_mode FROM enroll where payment_mode='Paytm';
SELECT id,name,email,mobile,course,payment_mode FROM enroll where payment_mode='Cash';
SELECT id,name,email,mobile,course,status FROM enroll where status='Not enrolled';
SELECT id,name,email,mobile,course,status FROM enroll where status='Enrolled';
SELECT id,name,email,mobile,course,payment_status FROM enroll where payment_status='Paid';
SELECT id,name,email,mobile,course,payment_status FROM enroll where payment_status='Pending';
SELECT id,name,email,mobile,course,total_installment,installment_paid,next_installment_date,payment_status,installment_left, final_amount FROM enroll where installment_left=1;
SELECT id,name,email,mobile,course FROM enroll where installment_left=2;
SELECT * FROM enroll where total_installment=2;
SELECT * FROM enroll where total_installment=3;
SELECT * from batch b join enroll e on(b.id=e.id) where b.course='BD';
SELECT * FROM enroll e JOIN batch b ON(e.id=b.id) where e.course='FSD';
SELECT * FROM enroll e JOIN batch b ON(e.id=b.id) where e.course='AI';
SELECT * FROM enroll e JOIN batch b ON(e.id=b.id) where e.course='PY';
SELECT * FROM enroll where status='Enrolled' and course='BD';
SELECT * FROM enroll where status='Enrolled' and course='FSD';
SELECT * FROM enroll where status='Enrolled' and course='AI';
SELECT COUNT(name) FROM enroll where course="AI" and status='Enrolled';
INSERT into table enquiry values(151,'mar','mar@gemail.com',9988998899,'BD',30000,10,'16-09-21','DD','Enrolled'),(152,'mario','mario@gemail.com',9988998899,'AI',40000,15,'18-09-21','DND','Not Enrolled');